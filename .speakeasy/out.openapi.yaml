openapi: "3.1.0"
info:
  title: "Mix REST API"
  description: "REST API for the Mix application - session management, messaging, and system operations"
  version: "1.0.0"
servers:
  - url: "http://localhost:8088"
    description: "Development server"
x-speakeasy-retries: {"backoff": {"exponent": 1.5, "initialInterval": 500, "maxElapsedTime": 600000, "maxInterval": 60000}, "retryConnectionErrors": true, "statusCodes": ["5XX", "408", "429"], "strategy": "backoff"}
paths:
  "/api/auth/api-key":
    post:
      description: "Store API key for direct authentication with a specific provider"
      operationId: "storeApiKey"
      requestBody:
        content:
          "application/json":
            schema:
              properties:
                "api_key":
                  description: "API key for authentication"
                  type: "string"
                "provider":
                  description: "Provider name (anthropic, openai, openrouter, gemini, brave)"
                  enum:
                    - "anthropic"
                    - "openai"
                    - "openrouter"
                    - "gemini"
                    - "brave"
                  type: "string"
              required:
                - "provider"
                - "api_key"
              type: "object"
        required: true
      responses:
        "200":
          content:
            "application/json":
              schema:
                properties:
                  "message":
                    description: "Success message"
                    type: "string"
                  "provider":
                    description: "Provider name"
                    type: "string"
                  "status":
                    description: "Operation status (success)"
                    type: "string"
                type: "object"
          description: "API key stored status"
        "400":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Invalid request data or API key format"
        "500":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Internal server error"
      summary: "Store API key"
      tags:
        - "Authentication"
  "/api/auth/oauth-callback":
    post:
      description: "Process OAuth callback and exchange code for access token"
      operationId: "handleOAuthCallback"
      requestBody:
        content:
          "application/json":
            schema:
              properties:
                "code":
                  description: "Authorization code from OAuth provider"
                  type: "string"
                "provider":
                  description: "Provider name (anthropic)"
                  type: "string"
                "state":
                  description: "OAuth state for verification"
                  type: "string"
              required:
                - "provider"
                - "code"
                - "state"
              type: "object"
        required: true
      responses:
        "200":
          content:
            "application/json":
              schema:
                properties:
                  "expires_in":
                    description: "Seconds until token expiration"
                    type: "integer"
                  "message":
                    description: "Status message"
                    type: "string"
                  "provider":
                    description: "Provider name"
                    type: "string"
                  "status":
                    description: "Operation status"
                    type: "string"
                type: "object"
          description: "OAuth completion status"
        "400":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Invalid request parameters"
        "500":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Internal server error"
      summary: "Handle OAuth callback"
      tags:
        - "Authentication"
  "/api/auth/oauth/{provider}":
    post:
      description: "Initiate OAuth authentication flow for a specific provider"
      operationId: "startOAuthFlow"
      parameters:
        - description: "Provider name (currently only 'anthropic')"
          in: "path"
          name: "provider"
          required: true
          schema:
            type: "string"
      responses:
        "200":
          content:
            "application/json":
              schema:
                properties:
                  "auth_url":
                    description: "OAuth authorization URL to redirect to"
                    type: "string"
                  "message":
                    description: "Instructions for completing OAuth flow"
                    type: "string"
                  "state":
                    description: "OAuth state token for verification"
                    type: "string"
                type: "object"
          description: "OAuth authorization information"
        "400":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Invalid provider or OAuth not supported"
        "500":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Internal server error"
      summary: "Start OAuth authentication"
      tags:
        - "Authentication"
  "/api/auth/status":
    get:
      description: "Get authentication status for all supported providers"
      operationId: "getAuthStatus"
      responses:
        "200":
          content:
            "application/json":
              schema:
                properties:
                  "providers":
                    additionalProperties:
                      properties:
                        "auth_method":
                          description: "Authentication method (oauth, api_key, none)"
                          enum:
                            - "oauth"
                            - "api_key"
                            - "none"
                          type: "string"
                        "authenticated":
                          description: "Whether provider is authenticated"
                          type: "boolean"
                        "display_name":
                          description: "User-friendly provider name"
                          type: "string"
                      type: "object"
                    description: "Map of provider authentication status"
                    type: "object"
                type: "object"
          description: "Authentication status for all providers"
        "500":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Internal server error"
      summary: "Get authentication status"
      tags:
        - "Authentication"
  "/api/auth/validate":
    get:
      description: "Check if the user's preferred provider is authenticated"
      operationId: "validatePreferredProvider"
      responses:
        "200":
          content:
            "application/json":
              schema:
                properties:
                  "auth_method":
                    description: "Authentication method used"
                    enum:
                      - "oauth"
                      - "api_key"
                      - "none"
                    type: "string"
                  "message":
                    description: "Status message"
                    type: "string"
                  "provider":
                    description: "Preferred provider name"
                    type: "string"
                  "valid":
                    description: "Whether preferred provider is authenticated"
                    type: "boolean"
                type: "object"
          description: "Preferred provider validation status"
        "500":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Internal server error"
      summary: "Validate preferred provider"
      tags:
        - "Authentication"
  "/api/auth/{provider}":
    delete:
      description: "Delete stored API key and/or OAuth credentials for a provider"
      operationId: "deleteCredentials"
      parameters:
        - description: "Provider name (anthropic, openai, openrouter, gemini, brave)"
          in: "path"
          name: "provider"
          required: true
          schema:
            type: "string"
      responses:
        "200":
          content:
            "application/json":
              schema:
                properties:
                  "message":
                    description: "Status message"
                    type: "string"
                  "provider":
                    description: "Provider name"
                    type: "string"
                  "status":
                    description: "Operation status"
                    type: "string"
                type: "object"
          description: "Credentials deletion status"
        "400":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Invalid provider"
        "500":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Internal server error"
      summary: "Delete provider credentials"
      tags:
        - "Authentication"
  "/api/commands":
    get:
      description: "Retrieve list of all available commands"
      operationId: "listCommands"
      responses:
        "200":
          content:
            "application/json":
              schema:
                items:
                  properties:
                    "description":
                      description: "Command description"
                      type: "string"
                    "name":
                      description: "Command name"
                      type: "string"
                  type: "object"
                type: "array"
          description: "List of commands"
        "401":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Unauthorized - authentication required"
        "500":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Internal server error"
      summary: "List available commands"
      tags:
        - "System"
  "/api/commands/{name}":
    get:
      description: "Retrieve details about a specific command"
      operationId: "getCommand"
      parameters:
        - description: "Command name"
          in: "path"
          name: "name"
          required: true
          schema:
            type: "string"
      responses:
        "200":
          content:
            "application/json":
              schema:
                properties:
                  "description":
                    description: "Command description"
                    type: "string"
                  "name":
                    description: "Command name"
                    type: "string"
                  "usage":
                    description: "Command usage instructions"
                    type: "string"
                type: "object"
          description: "Command details"
        "404":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Command not found"
      summary: "Get specific command"
      tags:
        - "System"
  "/api/mcp":
    get:
      description: "Retrieve list of available Model Context Protocol (MCP) servers"
      operationId: "listMcpServers"
      responses:
        "200":
          content:
            "application/json":
              schema:
                items:
                  properties:
                    "connected":
                      description: "Whether the MCP server is currently connected"
                      type: "boolean"
                    "name":
                      description: "MCP server name"
                      type: "string"
                    "status":
                      description: "Server connection status (e.g., 'connected', 'failed', 'disconnected')"
                      type: "string"
                    "tools":
                      description: "List of tools provided by this MCP server (null if server is not connected)"
                      items:
                        properties:
                          "description":
                            description: "Tool description"
                            type: "string"
                          "name":
                            description: "Tool name"
                            type: "string"
                        required:
                          - "name"
                          - "description"
                        type: "object"
                      nullable: true
                      type: "array"
                  required:
                    - "name"
                    - "connected"
                    - "status"
                  type: "object"
                type: "array"
          description: "List of MCP servers"
        "401":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Unauthorized - authentication required"
        "500":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Internal server error"
      summary: "List MCP servers"
      tags:
        - "System"
  "/api/messages/history":
    get:
      description: "Retrieve message history across all sessions with optional pagination"
      operationId: "getMessageHistory"
      parameters:
        - description: "Maximum number of messages to return"
          in: "query"
          name: "limit"
          schema:
            default: 50
            maximum: 1000
            minimum: 1
            type: "integer"
        - description: "Number of messages to skip"
          in: "query"
          name: "offset"
          schema:
            default: 0
            minimum: 0
            type: "integer"
      responses:
        "200":
          content:
            "application/json":
              schema:
                items: {"$ref": "#/components/schemas/MessageData"}
                type: "array"
          description: "Message history"
        "401":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Unauthorized - authentication required"
        "500":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Internal server error"
      summary: "Get global message history"
      tags:
        - "Messages"
      x-speakeasy-name-override: "getHistory"
  "/api/permissions/{id}/deny":
    post:
      description: "Deny a specific permission"
      operationId: "denyPermission"
      parameters:
        - description: "Permission ID"
          in: "path"
          name: "id"
          required: true
          schema:
            type: "string"
      responses:
        "200":
          content:
            "application/json":
              schema:
                properties:
                  "denied":
                    description: "Whether permission was denied"
                    type: "boolean"
                type: "object"
          description: "Permission deny status"
        "401":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Unauthorized - authentication required"
        "404":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Permission not found"
        "500":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Internal server error"
      summary: "Deny permission"
      tags:
        - "Permissions"
      x-speakeasy-name-override: "deny"
  "/api/permissions/{id}/grant":
    post:
      description: "Grant a specific permission"
      operationId: "grantPermission"
      parameters:
        - description: "Permission ID"
          in: "path"
          name: "id"
          required: true
          schema:
            type: "string"
      responses:
        "200":
          content:
            "application/json":
              schema:
                properties:
                  "granted":
                    description: "Whether permission was granted"
                    type: "boolean"
                type: "object"
          description: "Permission grant status"
        "401":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Unauthorized - authentication required"
        "404":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Permission not found"
        "500":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Internal server error"
      summary: "Grant permission"
      tags:
        - "Permissions"
      x-speakeasy-name-override: "grant"
  "/api/preferences":
    get:
      description: "Retrieve current user preferences including model and provider settings"
      operationId: "getPreferences"
      responses:
        "200":
          content:
            "application/json":
              schema:
                properties:
                  "available_providers":
                    additionalProperties:
                      properties:
                        "display_name":
                          description: "User-friendly provider name"
                          type: "string"
                        "models":
                          description: "Available models from this provider"
                          items:
                            type: "string"
                          type: "array"
                      type: "object"
                    description: "Map of available AI providers and their models"
                    type: "object"
                  "preferences":
                    description: "User preferences (null if no preferences exist)"
                    nullable: true
                    properties:
                      "created_at":
                        description: "Unix timestamp when preferences were created"
                        type: "integer"
                      "main_agent_max_tokens":
                        description: "Maximum tokens for main agent responses"
                        type: "integer"
                      "main_agent_model":
                        description: "Main agent model ID"
                        type: "string"
                      "main_agent_reasoning_effort":
                        description: "Reasoning effort setting for main agent"
                        type: "string"
                      "preferred_provider":
                        description: "Preferred AI provider (anthropic, openai, openrouter)"
                        type: "string"
                      "sub_agent_max_tokens":
                        description: "Maximum tokens for sub agent responses"
                        type: "integer"
                      "sub_agent_model":
                        description: "Sub agent model ID"
                        type: "string"
                      "sub_agent_reasoning_effort":
                        description: "Reasoning effort setting for sub agent"
                        type: "string"
                      "updated_at":
                        description: "Unix timestamp of last update"
                        type: "integer"
                    type: "object"
                required:
                  - "available_providers"
                type: "object"
          description: "User preferences and available providers"
        "500":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Internal server error"
      summary: "Get user preferences"
      tags:
        - "Preferences"
      x-speakeasy-name-override: get
    post:
      description: "Update user preferences including model and provider settings"
      operationId: "updatePreferences"
      requestBody:
        content:
          "application/json":
            schema:
              properties:
                "main_agent_max_tokens":
                  description: "Maximum tokens for main agent responses"
                  type: "integer"
                "main_agent_model":
                  description: "Main agent model ID"
                  type: "string"
                "main_agent_reasoning_effort":
                  description: "Reasoning effort setting for main agent"
                  type: "string"
                "preferred_provider":
                  description: "Preferred AI provider (anthropic, openai, openrouter)"
                  type: "string"
                "sub_agent_max_tokens":
                  description: "Maximum tokens for sub agent responses"
                  type: "integer"
                "sub_agent_model":
                  description: "Sub agent model ID"
                  type: "string"
                "sub_agent_reasoning_effort":
                  description: "Reasoning effort setting for sub agent"
                  type: "string"
              type: "object"
        required: true
      responses:
        "200":
          content:
            "application/json":
              schema:
                properties:
                  "created_at":
                    description: "Creation timestamp"
                    type: "integer"
                  "main_agent_max_tokens":
                    description: "Maximum tokens for main agent"
                    type: "integer"
                  "main_agent_model":
                    description: "Main agent model ID"
                    type: "string"
                  "main_agent_reasoning_effort":
                    description: "Reasoning effort for main agent"
                    type: "string"
                  "preferred_provider":
                    description: "Preferred AI provider"
                    type: "string"
                  "sub_agent_max_tokens":
                    description: "Maximum tokens for sub agent"
                    type: "integer"
                  "sub_agent_model":
                    description: "Sub agent model ID"
                    type: "string"
                  "sub_agent_reasoning_effort":
                    description: "Reasoning effort for sub agent"
                    type: "string"
                  "updated_at":
                    description: "Last update timestamp"
                    type: "integer"
                type: "object"
          description: "Updated preferences"
        "400":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Invalid request parameters"
        "500":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Internal server error"
      summary: "Update user preferences"
      tags:
        - "Preferences"
      x-speakeasy-name-override: update
  "/api/preferences/providers":
    get:
      description: "Retrieve list of available AI providers and their supported models"
      operationId: "getAvailableProviders"
      responses:
        "200":
          content:
            "application/json":
              schema:
                additionalProperties:
                  properties:
                    "display_name":
                      description: "Provider display name"
                      type: "string"
                    "models":
                      description: "Available models for this provider"
                      items:
                        type: "string"
                      type: "array"
                  type: "object"
                description: "Map of available providers and their models"
                type: "object"
          description: "Available providers"
        "500":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Internal server error"
      summary: "Get available providers"
      tags:
        - "Preferences"
      x-speakeasy-name-override: getProviders
  "/api/preferences/reset":
    post:
      description: "Reset user preferences to default values"
      operationId: "resetPreferences"
      responses:
        "200":
          content:
            "application/json":
              schema:
                properties:
                  "created_at":
                    description: "Creation timestamp"
                    type: "integer"
                  "main_agent_max_tokens":
                    description: "Reset main agent max tokens"
                    type: "integer"
                  "main_agent_model":
                    description: "Reset main agent model"
                    type: "string"
                  "main_agent_reasoning_effort":
                    description: "Reset main agent reasoning effort"
                    type: "string"
                  "preferred_provider":
                    description: "Reset preferred provider"
                    type: "string"
                  "sub_agent_max_tokens":
                    description: "Reset sub agent max tokens"
                    type: "integer"
                  "sub_agent_model":
                    description: "Reset sub agent model"
                    type: "string"
                  "sub_agent_reasoning_effort":
                    description: "Reset sub agent reasoning effort"
                    type: "string"
                  "updated_at":
                    description: "Reset timestamp"
                    type: "integer"
                type: "object"
          description: "Reset preferences"
        "500":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Internal server error"
      summary: "Reset preferences"
      tags:
        - "Preferences"
      x-speakeasy-name-override: reset
  "/api/sessions":
    get:
      description: "Retrieve a list of all available sessions with their metadata"
      operationId: "listSessions"
      responses:
        "200":
          content:
            "application/json":
              schema:
                items: {"$ref": "#/components/schemas/SessionData"}
                type: "array"
          description: "List of sessions"
        "401":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Unauthorized - authentication required"
        "500":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Internal server error"
      summary: "List all sessions"
      tags:
        - "Sessions"
      x-speakeasy-name-override: "list"
    post:
      description: "Create a new session with required title. Session automatically gets isolated storage directory."
      operationId: "createSession"
      requestBody:
        content:
          "application/json":
            schema:
              properties:
                "title":
                  description: "Title for the session"
                  type: "string"
                "workingDirectory":
                  description: "Optional working directory path"
                  type: "string"
              required:
                - "title"
              type: "object"
        required: true
      responses:
        "201":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/SessionData"}
          description: "Created session"
        "400":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Invalid request data"
      summary: "Create a new session"
      tags:
        - "Sessions"
      x-speakeasy-name-override: "create"
  "/api/sessions/{id}":
    delete:
      description: "Permanently delete a session and all its data"
      operationId: "deleteSession"
      parameters:
        - description: "Session ID"
          in: "path"
          name: "id"
          required: true
          schema:
            type: "string"
      responses:
        "204":
          description: "Session deleted successfully"
        "404":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Session not found"
      summary: "Delete a session"
      tags:
        - "Sessions"
      x-speakeasy-name-override: "delete"
    get:
      description: "Retrieve detailed information about a specific session"
      operationId: "getSession"
      parameters:
        - description: "Session ID"
          in: "path"
          name: "id"
          required: true
          schema:
            type: "string"
      responses:
        "200":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/SessionData"}
          description: "Session details"
        "404":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Session not found"
      summary: "Get a specific session"
      tags:
        - "Sessions"
      x-speakeasy-name-override: "get"
  "/api/sessions/{id}/cancel":
    post:
      description: "Cancel any ongoing agent processing in the specified session"
      operationId: "cancelSessionProcessing"
      parameters:
        - description: "Session ID"
          in: "path"
          name: "id"
          required: true
          schema:
            type: "string"
      responses:
        "200":
          content:
            "application/json":
              schema:
                properties:
                  "cancelled":
                    description: "Whether cancellation was successful"
                    type: "boolean"
                type: "object"
          description: "Cancellation status"
        "404":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Session not found"
      summary: "Cancel agent processing"
      tags:
        - "Messages"
      x-speakeasy-name-override: "cancelProcessing"
  "/api/sessions/{id}/files":
    get:
      description: "List all files in session storage directory"
      operationId: "listSessionFiles"
      parameters:
        - description: "Session ID"
          in: "path"
          name: "id"
          required: true
          schema:
            type: "string"
      responses:
        "200":
          content:
            "application/json":
              schema:
                items: {"$ref": "#/components/schemas/FileInfo"}
                type: "array"
          description: "List of files in session"
        "404":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Session not found"
      summary: "List session files"
      tags:
        - "Files"
      x-speakeasy-name-override: list
  "/api/sessions/{id}/files/upload":
    post:
      description: "Upload a file to session-specific storage directory"
      operationId: "uploadSessionFile"
      parameters:
        - description: "Session ID"
          in: "path"
          name: "id"
          required: true
          schema:
            type: "string"
      requestBody:
        content:
          "multipart/form-data":
            schema:
              properties:
                "file":
                  description: "File to upload"
                  format: "binary"
                  type: "string"
              required:
                - "file"
              type: "object"
        required: true
      responses:
        "201":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/FileInfo"}
          description: "File uploaded successfully"
        "400":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Invalid file or session ID"
        "404":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Session not found"
        "413":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "File too large (max 32MB)"
      summary: "Upload file to session"
      tags:
        - "Files"
      x-speakeasy-name-override: upload
  "/api/sessions/{id}/files/{filename}":
    delete:
      description: "Delete a specific file from session storage"
      operationId: "deleteSessionFile"
      parameters:
        - description: "Session ID"
          in: "path"
          name: "id"
          required: true
          schema:
            type: "string"
        - description: "Filename to delete"
          in: "path"
          name: "filename"
          required: true
          schema:
            type: "string"
      responses:
        "204":
          description: "File deleted successfully"
        "404":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Session or file not found"
      summary: "Delete session file"
      tags:
        - "Files"
      x-speakeasy-name-override: delete
    get:
      description: "Download or serve a specific file from session storage. Supports thumbnail generation with ?thumb parameter."
      operationId: "getSessionFile"
      parameters:
        - description: "Session ID"
          in: "path"
          name: "id"
          required: true
          schema:
            type: "string"
        - description: "Filename to retrieve"
          in: "path"
          name: "filename"
          required: true
          schema:
            type: "string"
        - description: "Thumbnail specification: '100' (box), 'w100' (width), 'h100' (height)"
          in: "query"
          name: "thumb"
          schema:
            pattern: "^(\\d+|w\\d+|h\\d+)$"
            type: "string"
        - description: "Time offset in seconds for video thumbnails (default: 1.0)"
          in: "query"
          name: "time"
          schema:
            maximum: 86400
            minimum: 0
            type: "number"
      responses:
        "200":
          content:
            "application/octet-stream":
              schema:
                format: "binary"
                type: "string"
            "image/jpeg":
              schema:
                description: "Thumbnail image (when thumb parameter is used)"
                format: "binary"
                type: "string"
          description: "File content"
        "400":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Invalid filename or thumbnail parameters"
        "404":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Session or file not found"
      summary: "Get session file"
      tags:
        - "Files"
      x-speakeasy-name-override: get
  "/api/sessions/{id}/fork":
    post:
      description: "Create a new session based on an existing session, copying messages up to a specified index"
      operationId: "forkSession"
      parameters:
        - description: "Source session ID to fork from"
          in: "path"
          name: "id"
          required: true
          schema:
            type: "string"
      requestBody:
        content:
          "application/json":
            schema:
              properties:
                "messageIndex":
                  description: "Index of the last message to include in the fork (1-based)"
                  minimum: 1
                  type: "integer"
                "title":
                  description: "Optional title for the forked session (defaults to 'Forked Session')"
                  type: "string"
              required:
                - "messageIndex"
              type: "object"
        required: true
      responses:
        "201":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/SessionData"}
          description: "Forked session"
        "400":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Invalid request - messageIndex must be > 0"
        "404":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Source session not found"
      summary: "Fork a session"
      tags:
        - "Sessions"
      x-speakeasy-name-override: "fork"
  "/api/sessions/{id}/messages":
    get:
      description: "Retrieve all messages from a specific session"
      operationId: "getSessionMessages"
      parameters:
        - description: "Session ID"
          in: "path"
          name: "id"
          required: true
          schema:
            type: "string"
      responses:
        "200":
          content:
            "application/json":
              schema:
                items: {"$ref": "#/components/schemas/MessageData"}
                type: "array"
          description: "List of session messages"
        "404":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Session not found"
      summary: "List session messages"
      tags:
        - "Messages"
      x-speakeasy-name-override: "getSession"
    post:
      description: "Send a user message to a specific session for AI processing"
      operationId: "sendMessage"
      parameters:
        - description: "Session ID"
          in: "path"
          name: "id"
          required: true
          schema:
            type: "string"
      requestBody:
        content:
          "application/json":
            schema:
              properties:
                "content":
                  description: "Message content to send"
                  type: "string"
              required:
                - "content"
              type: "object"
        required: true
      responses:
        "200":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/MessageData"}
          description: "Message sent and processed"
        "400":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Invalid message data"
        "404":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Session not found"
      summary: "Send a message to session"
      tags:
        - "Messages"
      x-speakeasy-name-override: "send"
  "/api/tools/status":
    get:
      description: "Get status and authentication information for all available tools and categories"
      operationId: "getToolsStatus"
      responses:
        "200":
          content:
            "application/json":
              schema:
                properties:
                  "categories":
                    additionalProperties:
                      properties:
                        "display_name":
                          description: "User-friendly category name"
                          type: "string"
                        "tools":
                          description: "Available tools in this category"
                          items:
                            properties:
                              "api_key_required":
                                description: "Whether tool requires API key authentication"
                                type: "boolean"
                              "authenticated":
                                description: "Whether tool is authenticated and ready to use"
                                type: "boolean"
                              "description":
                                description: "Tool description"
                                type: "string"
                              "display_name":
                                description: "User-friendly tool name"
                                type: "string"
                              "provider":
                                description: "Tool provider name"
                                type: "string"
                            type: "object"
                          type: "array"
                      type: "object"
                    description: "Map of tool categories and their tools"
                    type: "object"
                type: "object"
          description: "Tools status and authentication information"
        "500":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Internal server error"
      summary: "Get tools status"
      tags:
        - "Tools"
  "/health":
    get:
      description: "Check server health and status"
      operationId: "healthCheck"
      responses:
        "200":
          content:
            "application/json":
              schema:
                properties:
                  "status":
                    description: "Health status"
                    type: "string"
                  "timestamp":
                    description: "Current timestamp"
                    type: "string"
                  "version":
                    description: "Application version"
                    type: "string"
                type: "object"
          description: "Health information"
        "500":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Internal server error"
      summary: "Health check"
      tags:
        - "System"
  "/stream":
    get:
      description: "Establishes a persistent SSE connection for receiving real-time updates during message processing. Connection remains open for multiple messages and includes proper reconnection support with Last-Event-ID header."
      operationId: "streamEvents"
      parameters:
        - description: "Session ID to stream events for"
          in: "query"
          name: "sessionId"
          required: true
          schema:
            type: "string"
        - description: "Last received event ID for reconnection and event replay"
          in: "header"
          name: "Last-Event-ID"
          required: false
          schema:
            type: "string"
      responses:
        "200":
          content:
            "text/event-stream":
              schema: {"$ref": "#/components/schemas/SSEEventStream"}
          description: "SSE event stream"
          headers:
            "Cache-Control":
              description: "Prevents caching of the event stream"
              schema:
                example: "no-cache"
                type: "string"
              example: "no-cache"
            "Connection":
              description: "Keep connection alive for streaming"
              schema:
                example: "keep-alive"
                type: "string"
              example: "keep-alive"
            "Content-Type":
              description: "Server-sent events MIME type"
              schema:
                example: "text/event-stream"
                type: "string"
              example: "text/event-stream"
        "404":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Session not found"
        "500":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Internal server error"
      summary: "Server-Sent Events stream for real-time updates"
      tags:
        - "Streaming"
  "/stream/{id}/message":
    post:
      description: "Send a message to a session via the streaming pipeline. This endpoint integrates with active SSE connections to broadcast real-time processing events including thinking, content, tool execution, and completion events."
      operationId: "sendStreamingMessage"
      parameters:
        - description: "Session ID to send message to"
          in: "path"
          name: "id"
          required: true
          schema:
            type: "string"
      requestBody:
        content:
          "application/json":
            schema:
              properties:
                "content":
                  description: "Message content to send for processing"
                  type: "string"
              required:
                - "content"
              type: "object"
        required: true
      responses:
        "200":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/StreamMessageResponse"}
          description: "Message broadcasted to streaming pipeline. Real-time processing events will be sent via active SSE connections."
        "400":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Invalid message content"
        "404":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Session not found"
        "500":
          content:
            "application/json":
              schema: {"$ref": "#/components/schemas/ErrorResponse"}
          description: "Internal server error"
      summary: "Send message via streaming pipeline"
      tags:
        - "Streaming"
components:
  schemas:
    "ErrorResponse":
      properties:
        "error": {"$ref": "#/components/schemas/RESTError"}
      required:
        - "error"
      type: "object"
    "FileInfo":
      properties:
        "isDir":
          description: "Whether this is a directory"
          type: "boolean"
        "modified":
          description: "Last modified timestamp (Unix time)"
          format: "int64"
          type: "integer"
        "name":
          description: "File name"
          type: "string"
        "size":
          description: "File size in bytes"
          format: "int64"
          type: "integer"
      required:
        - "name"
        - "size"
        - "modified"
        - "isDir"
      type: "object"
    "MessageData":
      properties:
        "assistantResponse":
          description: "Assistant's response message (optional)"
          type: "string"
        "id":
          description: "Unique message identifier"
          type: "string"
        "reasoning":
          description: "Reasoning process (optional)"
          type: "string"
        "reasoningDuration":
          description: "Reasoning duration in milliseconds (optional)"
          type: "integer"
        "role": {"$ref": "#/components/schemas/MessageRole"}
        "sessionId":
          description: "Session identifier"
          type: "string"
        "toolCalls":
          description: "Tool calls made during message processing"
          items: {"$ref": "#/components/schemas/ToolCallData"}
          type: "array"
        "userInput":
          description: "User's input message"
          type: "string"
      required:
        - "id"
        - "sessionId"
        - "role"
        - "userInput"
      type: "object"
    "MessageRole":
      description: "Message role"
      enum:
        - "user"
        - "assistant"
        - "tool"
      type: "string"
    "RESTError":
      properties:
        "code":
          description: "HTTP status code"
          type: "integer"
        "message":
          description: "Error message"
          type: "string"
        "type":
          description: "Error type"
          enum:
            - "bad_request"
            - "not_found"
            - "internal_error"
            - "unauthorized"
            - "validation_error"
          type: "string"
      required:
        - "code"
        - "message"
        - "type"
      type: "object"
    "SSEBaseEvent":
      description: "Base SSE event with standard fields"
      properties:
        "event":
          description: "Event type identifier"
          enum:
            - "connected"
            - "heartbeat"
            - "error"
            - "complete"
            - "thinking"
            - "content"
            - "tool"
            - "tool_execution_start"
            - "tool_execution_complete"
            - "permission"
            - "summarize"
          type: "string"
        "id":
          description: "Unique sequential event identifier for ordering and reconnection"
          example: "1234567890"
          type: "string"
        "retry":
          description: "Client retry interval in milliseconds"
          example: 30000
          type: "integer"
      required:
        - "id"
        - "event"
      type: "object"
    "SSECompleteEvent":
      allOf:
        - {"$ref": "#/components/schemas/SSEBaseEvent"}
        - properties:
            "data":
              properties:
                "content":
                  description: "Final response content"
                  type: "string"
                "done":
                  description: "Indicates message processing completion"
                  type: "boolean"
                "messageId":
                  description: "Completed message identifier"
                  type: "string"
                "reasoning":
                  description: "Optional reasoning content"
                  type: "string"
                "reasoningDuration":
                  description: "Duration of reasoning process in milliseconds"
                  type: "integer"
                "type":
                  description: "Completion type"
                  type: "string"
              required:
                - "type"
                - "done"
              type: "object"
          required:
            - "data"
          type: "object"
    "SSEConnectedEvent":
      allOf:
        - {"$ref": "#/components/schemas/SSEBaseEvent"}
        - properties:
            "data":
              properties:
                "sessionId":
                  description: "Session identifier for the connected stream"
                  type: "string"
              required:
                - "sessionId"
              type: "object"
          required:
            - "data"
          type: "object"
    "SSEContentEvent":
      allOf:
        - {"$ref": "#/components/schemas/SSEBaseEvent"}
        - properties:
            "data":
              properties:
                "content":
                  description: "Streaming content delta"
                  type: "string"
                "type":
                  description: "Content event type"
                  type: "string"
              required:
                - "type"
                - "content"
              type: "object"
          required:
            - "data"
          type: "object"
    "SSEErrorEvent":
      allOf:
        - {"$ref": "#/components/schemas/SSEBaseEvent"}
        - properties:
            "data":
              properties:
                "attempt":
                  description: "Current retry attempt number"
                  type: "integer"
                "error":
                  description: "Error message description"
                  type: "string"
                "maxAttempts":
                  description: "Maximum number of retry attempts"
                  type: "integer"
                "retryAfter":
                  description: "Milliseconds to wait before retry"
                  type: "integer"
                "type":
                  description: "Error type classification"
                  type: "string"
              required:
                - "error"
              type: "object"
          required:
            - "data"
          type: "object"
    "SSEEventStream":
      description: "Server-Sent Event stream with discriminated event types"
      discriminator:
        mapping:
          "complete": "#/components/schemas/SSECompleteEvent"
          "connected": "#/components/schemas/SSEConnectedEvent"
          "content": "#/components/schemas/SSEContentEvent"
          "error": "#/components/schemas/SSEErrorEvent"
          "heartbeat": "#/components/schemas/SSEHeartbeatEvent"
          "permission": "#/components/schemas/SSEPermissionEvent"
          "summarize": "#/components/schemas/SSESummarizeEvent"
          "thinking": "#/components/schemas/SSEThinkingEvent"
          "tool": "#/components/schemas/SSEToolEvent"
          "tool_execution_complete": "#/components/schemas/SSEToolExecutionCompleteEvent"
          "tool_execution_start": "#/components/schemas/SSEToolExecutionStartEvent"
        propertyName: "event"
      oneOf:
        - {"$ref": "#/components/schemas/SSEConnectedEvent"}
        - {"$ref": "#/components/schemas/SSEHeartbeatEvent"}
        - {"$ref": "#/components/schemas/SSEErrorEvent"}
        - {"$ref": "#/components/schemas/SSECompleteEvent"}
        - {"$ref": "#/components/schemas/SSEThinkingEvent"}
        - {"$ref": "#/components/schemas/SSEContentEvent"}
        - {"$ref": "#/components/schemas/SSEToolEvent"}
        - {"$ref": "#/components/schemas/SSEToolExecutionStartEvent"}
        - {"$ref": "#/components/schemas/SSEToolExecutionCompleteEvent"}
        - {"$ref": "#/components/schemas/SSEPermissionEvent"}
        - {"$ref": "#/components/schemas/SSESummarizeEvent"}
      type: "object"
    "SSEHeartbeatEvent":
      allOf:
        - {"$ref": "#/components/schemas/SSEBaseEvent"}
        - properties:
            "data":
              properties:
                "type":
                  description: "Heartbeat type"
                  example: "ping"
                  type: "string"
              required:
                - "type"
              type: "object"
          required:
            - "data"
          type: "object"
    "SSEPermissionEvent":
      allOf:
        - {"$ref": "#/components/schemas/SSEBaseEvent"}
        - properties:
            "data":
              properties:
                "action":
                  description: "Requested action description"
                  type: "string"
                "description":
                  description: "Human-readable permission description"
                  type: "string"
                "id":
                  description: "Permission request identifier"
                  type: "string"
                "params":
                  description: "Additional parameters for the permission request"
                  type: "object"
                "path":
                  description: "File path for permission request"
                  type: "string"
                "sessionId":
                  description: "Session identifier for the permission request"
                  type: "string"
                "toolName":
                  description: "Tool requiring permission"
                  type: "string"
                "type":
                  description: "Permission event type"
                  type: "string"
              required:
                - "type"
                - "id"
                - "sessionId"
                - "toolName"
                - "description"
                - "action"
              type: "object"
          required:
            - "data"
          type: "object"
    "SSESummarizeEvent":
      allOf:
        - {"$ref": "#/components/schemas/SSEBaseEvent"}
        - properties:
            "data":
              properties:
                "done":
                  description: "Indicates if summarization is complete"
                  type: "boolean"
                "progress":
                  description: "Summarization progress description"
                  type: "string"
                "type":
                  description: "Summarization event type"
                  type: "string"
              required:
                - "type"
                - "progress"
                - "done"
              type: "object"
          required:
            - "data"
          type: "object"
    "SSEThinkingEvent":
      allOf:
        - {"$ref": "#/components/schemas/SSEBaseEvent"}
        - properties:
            "data":
              properties:
                "content":
                  description: "Thinking or reasoning content"
                  type: "string"
                "type":
                  description: "Thinking event type"
                  type: "string"
              required:
                - "type"
                - "content"
              type: "object"
          required:
            - "data"
          type: "object"
    "SSEToolEvent":
      allOf:
        - {"$ref": "#/components/schemas/SSEBaseEvent"}
        - properties:
            "data":
              properties:
                "id":
                  description: "Tool execution identifier"
                  type: "string"
                "input":
                  description: "Tool input parameters"
                  type: "string"
                "name":
                  description: "Tool name being executed"
                  type: "string"
                "status":
                  description: "Tool execution status"
                  type: "string"
                "type":
                  description: "Tool event type"
                  type: "string"
              required:
                - "type"
                - "name"
                - "input"
                - "id"
                - "status"
              type: "object"
          required:
            - "data"
          type: "object"
    "SSEToolExecutionCompleteEvent":
      allOf:
        - {"$ref": "#/components/schemas/SSEBaseEvent"}
        - properties:
            "data":
              properties:
                "progress":
                  description: "Final execution progress description"
                  type: "string"
                "success":
                  description: "Indicates if tool execution succeeded"
                  type: "boolean"
                "toolCallId":
                  description: "Tool call identifier"
                  type: "string"
                "toolName":
                  description: "Name of the completed tool"
                  type: "string"
                "type":
                  description: "Tool execution complete event type"
                  type: "string"
              required:
                - "type"
                - "toolName"
                - "progress"
                - "success"
                - "toolCallId"
              type: "object"
          required:
            - "data"
          type: "object"
    "SSEToolExecutionStartEvent":
      allOf:
        - {"$ref": "#/components/schemas/SSEBaseEvent"}
        - properties:
            "data":
              properties:
                "progress":
                  description: "Execution progress description"
                  type: "string"
                "toolCallId":
                  description: "Tool call identifier"
                  type: "string"
                "toolName":
                  description: "Name of the tool being executed"
                  type: "string"
                "type":
                  description: "Tool execution start event type"
                  type: "string"
              required:
                - "type"
                - "toolName"
                - "progress"
                - "toolCallId"
              type: "object"
          required:
            - "data"
          type: "object"
    "SessionData":
      properties:
        "assistantMessageCount":
          description: "Number of assistant messages in session"
          type: "integer"
        "completionTokens":
          description: "Total completion tokens used"
          type: "integer"
        "cost":
          description: "Total cost of session"
          format: "double"
          type: "number"
        "createdAt":
          description: "Session creation timestamp"
          format: "date-time"
          type: "string"
        "firstUserMessage":
          description: "First user message (optional)"
          type: "string"
        "id":
          description: "Unique session identifier"
          type: "string"
        "promptTokens":
          description: "Total prompt tokens used"
          type: "integer"
        "title":
          description: "Session title"
          type: "string"
        "toolCallCount":
          description: "Number of tool calls made in session"
          type: "integer"
        "userMessageCount":
          description: "Number of user messages in session"
          type: "integer"
        "workingDirectory":
          description: "Working directory path (optional)"
          type: "string"
      required:
        - "id"
        - "title"
        - "userMessageCount"
        - "assistantMessageCount"
        - "toolCallCount"
        - "promptTokens"
        - "completionTokens"
        - "cost"
        - "createdAt"
      type: "object"
    "StreamMessageResponse":
      description: "Response from streaming message endpoint indicating broadcast status"
      properties:
        "sessionId":
          description: "Session identifier"
          type: "string"
        "status":
          description: "Broadcast status"
          enum:
            - "broadcasted"
          type: "string"
      required:
        - "status"
        - "sessionId"
      type: "object"
    "ToolCallData":
      properties:
        "finished":
          description: "Whether tool call has finished"
          type: "boolean"
        "id":
          description: "Unique tool call identifier"
          type: "string"
        "input":
          description: "Tool input parameters"
          type: "string"
        "isError":
          description: "Whether tool call resulted in error (optional)"
          type: "boolean"
        "name":
          description: "Tool name"
          type: "string"
        "result":
          description: "Tool execution result (optional)"
          type: "string"
        "type":
          description: "Tool type"
          type: "string"
      required:
        - "id"
        - "name"
        - "input"
        - "type"
        - "finished"
      type: "object"
